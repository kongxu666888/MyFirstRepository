# 音乐推荐管理系统 - 部署说明

## 📋 系统要求

### 软件环境
- **操作系统**: Windows 10/11
- **Python**: 3.8 或更高版本
- **Node.js**: 18.0 或更高版本  
- **MySQL**: 5.7 或更高版本

### 硬件要求
- **内存**: 最少 4GB RAM
- **存储**: 最少 2GB 可用空间
- **网络**: 需要互联网连接（用于下载依赖）

## 🚀 快速部署

### 方式一：一键部署（推荐）

1. **下载必要软件**
   - Python 3.8: https://www.python.org/ftp/python/3.8.10/python-3.8.10-amd64.exe
   - MySQL 5.7: https://dev.mysql.com/get/Downloads/MySQLInstaller/mysql-installer-community-5.7.44.0.msi
   - Node.js 18: https://nodejs.org/dist/v18.20.2/node-v18.20.2-x64.msi

2. **配置环境**
   ```bash
   # 双击运行
   setup_env.bat
   ```

3. **初始化数据库**
   ```bash
   # 双击运行
   init_database.bat
   ```

4. **启动系统**
   ```bash
   # 双击运行
   start.bat
   ```

### 方式二：手动部署

#### 步骤1：环境准备
```bash
# 1. 创建Python虚拟环境
python -m venv venv

# 2. 激活虚拟环境
venv\Scripts\activate.bat

# 3. 安装后端依赖
cd server
pip install -r requirements.txt
cd ..

# 4. 安装前端依赖
cd web
npm install
cd ..
```

#### 步骤2：数据库配置
```sql
-- 1. 创建数据库
CREATE DATABASE IF NOT EXISTS python_music DEFAULT CHARSET utf8 COLLATE utf8_general_ci;

-- 2. 导入数据
mysql -u root -p python_music < server/python_music.sql
```

#### 步骤3：修改配置
编辑 `server/server/settings.py` 文件中的数据库配置：
```python
DATABASES = {
    'default': {
        'ENGINE': 'django.db.backends.mysql',
        'NAME': 'python_music',   # 数据库名
        'USER': 'root',           # 用户名
        'PASSWORD': '你的密码',    # 密码
        'HOST': '127.0.0.1',
        'PORT': '3306',
    }
}
```

#### 步骤4：启动服务
```bash
# 1. 启动后端服务
cd server
python manage.py runserver 127.0.0.1:8000

# 2. 启动前端服务（新开命令行窗口）
cd web
npm run dev
```

## 📁 脚本文件说明

| 文件名 | 功能描述 |
|--------|----------|
| `setup_env.bat` | 环境配置脚本，安装依赖和创建虚拟环境 |
| `init_database.bat` | 数据库初始化脚本，创建数据库并导入数据 |
| `start.bat` | 一键启动脚本，同时启动前后端服务 |
| `stop.bat` | 停止服务脚本，关闭所有相关进程 |
| `build_frontend.bat` | 前端构建脚本，用于生产环境部署 |

## 🌐 访问地址

启动成功后，可以通过以下地址访问：

- **前端页面**: http://localhost:5173
- **后端API**: http://localhost:8000  
- **管理后台**: http://localhost:8000/admin

## 👤 默认账号

- **管理员用户名**: admin123
- **管理员密码**: admin123

## 🔧 常见问题

### 1. 端口被占用
**问题**: 启动时提示端口8000或5173被占用
**解决**: 
```bash
# 查看端口占用
netstat -ano | findstr :8000
netstat -ano | findstr :5173

# 结束占用进程
taskkill /f /pid [进程ID]

# 或运行停止脚本
stop.bat
```

### 2. 数据库连接失败
**问题**: 提示数据库连接错误
**解决**:
1. 确认MySQL服务已启动
2. 检查用户名密码是否正确
3. 确认数据库已创建
4. 重新运行 `init_database.bat`

### 3. Python依赖安装失败
**问题**: pip安装依赖时出错
**解决**:
```bash
# 升级pip
python -m pip install --upgrade pip

# 使用国内镜像源
pip install -r requirements.txt -i https://pypi.tuna.tsinghua.edu.cn/simple/
```

### 4. 前端依赖安装失败
**问题**: npm安装依赖时出错
**解决**:
```bash
# 清理缓存
npm cache clean --force

# 使用淘宝镜像
npm install --registry https://registry.npmmirror.com

# 或使用yarn
yarn install
```

## 📝 开发说明

### 目录结构
```
music_py_vue/
├── server/          # Django后端
│   ├── manage.py
│   ├── requirements.txt
│   ├── server/      # 项目配置
│   └── myapp/       # 应用代码
├── web/             # Vue前端
│   ├── src/
│   ├── package.json
│   └── vite.config.ts
├── venv/            # Python虚拟环境
├── setup_env.bat    # 环境配置脚本
├── start.bat        # 启动脚本
└── stop.bat         # 停止脚本
```

### 开发模式
```bash
# 后端开发
cd server
python manage.py runserver --settings=server.settings_dev

# 前端开发
cd web
npm run dev
```

### 生产部署
```bash
# 构建前端
build_frontend.bat

# 配置生产环境
# 修改settings.py中的DEBUG=False
# 配置ALLOWED_HOSTS
# 使用nginx或Apache部署静态文件
```

## 📞 技术支持

如遇到问题，请联系：
- **邮箱**: kefu308@gmail.com
- **微信**: Lengqin1024

## 🔍 系统检查

运行 `check_system.bat` 可以检查系统环境是否满足要求。

---

**注意**: 本系统仅供学习使用，请遵守相关版权协议。
